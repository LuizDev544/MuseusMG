<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel ADM</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../FrontEnd/styles/paineladm.css">
</head>
<body>
    <div class="top-bar">
        <div class="container text-center py-4">
            <header class="mb-3">
                <h1 class="display-5 fw-bold texto-laranja">Painel de Administra√ß√£o de Museus</h1>
            </header>
            <div class="actions-bar mb-2">
                <a href="PainelCadastro.html" class="btn btn-light btn-action shadow-sm">
                    <i data-feather="plus-circle"></i> Cadastrar Museus
                </a>
                <a href="PainelExcluir.html" class="btn btn-warning btn-action shadow-sm">
                    <i data-feather="trash-2"></i> Excluir Museus
                </a>
                <a href="PainelConsulta.html" class="btn btn-dark btn-action shadow-sm">
                    <i data-feather="search"></i> Consultar Museus
                </a>
                <button data-logout="true" class="btn btn-outline-light">Sair</button>
                <br><br><br>
                <div class="thumb" tabindex="0">
                    <img src="Imagens/Speed.gif" alt="Descri√ß√£o da imagem">
                </div>
            </div>
        </div>
    </div>
    
    <section class="hero-image"></section>
    
    <div class="container py-4 dashboard-container">
        <div class="card shadow-sm">
            <div class="card-header custom-orange">
                Lista de Museus Cadastrados
            </div>
            <div class="card-body p-0 table-responsive">
                <table class="table table-striped table-hover mb-0" id="tabelaEventos">
                    <thead class="custom-header">
                        <tr>
                            <th>ID</th>
                            <th>Museu</th>
                            <th>Descri√ß√£o</th>
                            <th>Hora Entrada</th>
                            <th>Hora Saida</th>
                            <th>Tema</th>
                            <th>Capacidade</th>
                            <th>Funda√ß√£o</th>
                            <th>Endere√ßo</th>
                            <th>Pre√ßo</th>
                            <th class="text-center">A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Dados carregados via JavaScript -->
                    </tbody>
                </table>
                
                <!-- Formul√°rio de Edi√ß√£o -->
                <form id="formEdicao" style="display: none;">
                    <button type="button" class="btn-close-form" onclick="fecharFormulario()">√ó</button>
                    <h5 class="mb-3" style="color: #e2ad7c;">‚úèÔ∏è Editar Museu</h5>  
                    <input type="hidden" id="inputId" name="id">
                    <div class="row g-3">
                        <div class="col-md-4">
                            <label for="inputNome" class="form-label">Nome do Museu:</label>
                            <input type="text" id="inputNome" name="museu" class="form-control" required>
                        </div>
                        <div class="col-md-6">
                            <label for="inputDescricao" class="form-label">Descri√ß√£o:</label>
                            <input type="text" id="inputDescricao" name="descricaomuseu" class="form-control">
                        </div>
                        <div class="col-md-2">
                            <label for="inputCapacidade" class="form-label">Capacidade:</label>
                            <input type="number" step="0.01" id="inputCapacidade" name="capacidade" class="form-control">
                        </div>
                    </div>
                    <div class="row g-3 mt-2">
                        <div class="col-md-2">
                            <label for="InputEntrada" class="form-label">Hora de Entrada:</label>
                            <input type="time" id="InputEntrada" name="horarioabrir" class="form-control" required>
                        </div>
                        <div class="col-md-2">
                            <label for="inputSaida" class="form-label">Hora de Saida:</label>
                            <input type="time" id="inputSaida" name="horariosair" class="form-control" required>
                        </div>
                        <div class="col-md-8">
                            <label for="inputTema" class="form-label">Tema:</label>
                            <input type="text" id="inputTema" name="tema" class="form-control" required>
                        </div>
                    </div>
                    <div class="row g-3 mt-2">
                        <div class="col-md-4">
                            <label for="inputFundacao" class="form-label">Funda√ß√£o:</label>
                            <input type="text" id="inputFundacao" name="fundacao" class="form-control">
                        </div>
                        <div class="col-md-6">
                            <label for="inputEndereco" class="form-label">Endere√ßo:</label>
                            <input type="text" id="inputEndereco" name="endereco" class="form-control">
                        </div>
                        <div class="col-md-2">
                            <label for="inputPreco" class="form-label">Pre√ßo:</label>
                            <input type="text" id="inputPreco" name="preco" class="form-control">
                        </div>
                    </div>
                    <div class="mt-3 text-center">
                        <button type="submit" class="btn btn-success me-2">‚úÖ Salvar Altera√ß√µes</button>
                        <button type="button" class="btn btn-secondary" onclick="fecharFormulario()">‚ùå Cancelar</button>
                        <div id="msgEdicao" class="mt-3"></div>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Overlay para o formul√°rio --> 
    <div id="overlay" style="display: none;"></div>

    <!-- Scripts NA ORDEM CORRETA -->
    <script src="scripts/security-config.js"></script>
    <script src="scripts/protected-auth.js"></script>
    <script src="scripts/ListarMuseu.js"></script>
    <script src="scripts/Editar.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    
    <script>
    // Sistema de autentica√ß√£o do painel
    if (typeof ProtectedAuth !== 'undefined') {
        class PainelADMAuth extends ProtectedAuth {
            onAuthenticationSuccess(username) {
                console.log(`üéâ Painel ADM carregado para: ${username}`);
                
                // Inicializar funcionalidades do painel
                if (typeof listarMuseu !== 'undefined' && listarMuseu.init) {
                    listarMuseu.init();
                }
                
                // Inicializar √≠cones
                if (typeof feather !== 'undefined') {
                    feather.replace();
                }
                
                this.showAuthenticatedStatus(username);
            }

            showAuthenticatedStatus(username) {
                const header = document.querySelector('header');
                if (header) {
                    const statusDiv = document.createElement('div');
                    statusDiv.className = 'alert alert-success mt-3';
                    statusDiv.innerHTML = `‚úÖ Logado como: <strong>${username}</strong>`;
                    header.appendChild(statusDiv);
                }
            }
        }

        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', () => {
            console.log("üöÄ Inicializando Painel ADM...");
            new PainelADMAuth().init();
        });

    } else {
        console.error("‚ùå ProtectedAuth n√£o est√° dispon√≠vel");
        
        // Fallback
        document.addEventListener('DOMContentLoaded', () => {
            console.log("üîÑ Inicializando sem autentica√ß√£o...");
            if (typeof listarMuseu !== 'undefined' && listarMuseu.init) {
                listarMuseu.init();
            }
            if (typeof feather !== 'undefined') {
                feather.replace();
            }
        });
    }
    </script>
</body>
</html>